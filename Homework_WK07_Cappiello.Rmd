---
title: "Homework Chapter 7 - Mark Cappiello"
output: 
   word_document: default
---

3. Run cor.test() on the correlation between “area” and “perm” in the rock data set and interpret the results. Note that you will have to use the “$” accessor to get at each of the two variables (like this: rock$area). Make sure that you interpret both the confidence interval and the p-value that is generated by cor.test(). 

```{r}
library(datasets)
data("rock")
#head(rock)
cor_test_results <- cor.test(rock$area, rock$perm)
cor_test_results

```

Null hypothesis: in the rock data set there is no linear relationship between area and perm.

Alt hypothesis: there is a non-zero correlation between area and perm in the rock data set. (the two values are related)

The correlation coefficient of -0.396637 says that there is a negative correlation, as area increases perm decreases. 

With t = -2.9305 this shows that there is a negative correlation

The p-value = 0.005254 which is much smaller than the alpha of 0.05.  This indicates that the observed correlation is statistically significant

The confidence interval is -0.6118206, -0.1267915 which does not include zero and is completely negative suggests that there is a statistically significant negative correlation between area and perm.

Conclusion: With the given test results we can reject the null hypothesis and state that there is a statistically significant negative relationship between area and perm.  As area increases perm decreases.

---------------------------------------------------------------------------------------------------------

4. Create a copy of the bfCorTest() custom function presented in this chapter. Don’t forget to “source” it (meaning that you have to run the code that defines the function one time to make R aware of it). Conduct a Bayesian analysis of the correlation between “area” and “perm” in the rock data set. 

```{r}
#install.packages(BayesFactor) 
library("BayesFactor") 
bfCorTest <-function (x,y) #Get r from BayesFactor 
{ 
  zx <-scale(x) #Standardize X 
  zy <-scale(y) #Standardize Y 
  zData <-data.frame(x=zx,rhoNot0=zy) #Put in a data frame 
  bfOut <-generalTestBF(x ~ rhoNot0, data=zData) #linear coefficient 
  mcmcOut <-posterior(bfOut,iterations=10000) #posterior samples 
  print(summary(mcmcOut[,"rhoNot0"])) #Show the HDI for r 
  return(bfOut) #Return Bayes factor object 
} 

bfCorTest(rock$area,rock$perm)
```

Bayesian Analysis:

---------------------------------------------------------------------------------------------------------

8. Not unexpectedly, there is a data set in R that contains these data. The data set is called UCBAdmissions and you can access the department mentioned above like this: UCBAdmissions[, ,1]. Make sure you put two commas before the 1: this is a three dimensional contingency table that we are subsetting down to two dimensions. Run chisq.test() on this subset of the data set and make sense of the results. 


```{r}
# Get data for first department
data("UCBAdmissions")
dept1_data <- UCBAdmissions[, , 1]
dept1_data

# Perform the Chi-squared test
chisq_result <- chisq.test(dept1_data)
chisq_result


```



---------------------------------------------------------------------------------------------------------

9. Use contingencyTableBF() to conduct a Bayes factor analysis on the UCB admissions data. Report and interpret the Bayes factor.

```{r}

# Perform the Bayes factor analysis
bf_result <- contingencyTableBF(dept1_data, sampleType = "poisson", posterior = FALSE)
bf_result

bf_result_10k <- contingencyTableBF(dept1_data, sampleType = "poisson", posterior = FALSE, iterations = 10000)
bf_result_10k

```

